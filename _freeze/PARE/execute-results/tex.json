{
  "hash": "492a1261ae1a89399e30be2cb16ef93f",
  "result": {
    "markdown": "---\nexecute:\n    freeze: true\n---\n\n\n\n# PARE model\n\n## Load data, functions, and packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(dplyr)\nlibrary(sf)\nlibrary(spdep)\nlibrary(extRemes)\nlibrary(ggplot2)\nlibrary(patchwork)\n\nthresh = 253\n\nstations <- read.csv(\"Data/station_info.csv\")\nstat_nos <- stations[,1]\n\nsource(\"Code/HelperFunctions_PARE/format_data.R\")\nsource(\"Code/HelperFunctions_PARE/jitter_n_sym.R\")\nsource(\"Code/HelperFunctions_PARE/get_sym_car_mat.R\")\nsource(\"Code/HelperFunctions_PARE/get_par_car.R\")\nsource(\"Code/HelperFunctions_PARE/get_se.R\")\nsource(\"Code/HelperFunctions_PARE/pars_to_rl.R\")\nsource(\"Code/HelperFunctions_PARE/rl_with_ci.R\")\nsource(\"Code/HelperFunctions_PARE/make_varcov_mats_car.R\")\nsource(\"Code/HelperFunctions_PARE/rl_ci_to_plot_vec.R\")\nsource(\"Code/HelperFunctions_PARE/create_mat.R\")\nsource(\"Code/HelperFunctions_PARE/win_rl_to_plot_dat.R\")\nsource(\"Code/HelperFunctions_PARE/get_latex_table.R\")\n```\n:::\n\n\n\n## Format time series of GPD fits\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## load watershed data\nws_regs <- sf::read_sf(\"Data/watershed_region_updated\")\nst_crs(ws_regs) <-sf::st_crs(2278)\n\n## window object generated in Fit_GPD.qmd\n## Load rolling GPD fits (takes a bit)\nwindow <- readRDS(\"Data/window_1day_dclust_updated.rds\")  # list of lists (82 x 601) of GPD fits\nwindow_CVM <- readRDS(\"Data/window_CVM_updated.rds\")\nwindow_AD <- readRDS(\"Data/window_AD_updated.rds\")\n\n## Extract windows (note varying # stations)\ndat_win_22 <- format_data(window[[22]], stations, ws_regs, window_CVM[[22]]) # 34\ndat_win_52 <- format_data(window[[52]], stations, ws_regs, window_CVM[[52]]) # 28\ndat_win_82 <- format_data(window[[82]], stations, ws_regs, window_CVM[[82]]) # 149\n\n## save values (faster than reading entire window[[]] object)\nsave(dat_win_22, file = \"Data/dat_win_22\")\nsave(dat_win_52, file = \"Data/dat_win_52\")\nsave(dat_win_82, file = \"Data/dat_win_82\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n## Construct spatial weight matrices\n\n::: {.callout-note collapse=\"true\"}\n## Generating the Hausdorff matrix\n\nThe `hausMat` function and additional documentation can be found in the [`hausdorff` Github repository](https://github.com/juliaSchedler/hausdorff).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# (make sure ws_regs is projected first)\ndistMat <- hausMat(ws_regs, f1 = 0.5)\ndistMat/5280\n\n# save output\n# saveRDS(distMat, file = \"~/Documents/GitHub/Spatial_Extreme_Value_Modeling/Data/hMat_med.rds\")\n```\n:::\n\n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read in previously computed Hausdorff matrix and convert units to miles\nhMat <- readRDS(file = \"Data/hMat_med.rds\")\nhMat_miles <- hMat/5280\n\n## Create weight matrix for each window \n## Accounts for different numbers of stations (varying point-to-area structure)\n## Jiters the values to give valid weight matrix\nset.seed(24)\nD_22 <- get_sym_car_mat(dat_win_22, hMat_miles)\nD_52 <- get_sym_car_mat(dat_win_52, hMat_miles)\nD_82 <- get_sym_car_mat(dat_win_82, hMat_miles)\n```\n:::\n\n\n\n## Fit models to each window for each parameter\n\nTo obtain region-level estimates of the GPD parameters, fit a conditional auto-regressive model for each GPD parameter for each window, a total of 9 models.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## window 22\n## Fit models\ncar_shape_22 <- spatialreg::spautolm(shape ~ -1 + Reg1 + Reg2 + Reg3, \n                                     data = dat_win_22, family=\"CAR\", \n                                     listw=mat2listw(1/D_22, style = \"C\"))\ncar_ln.scale_22 <- spatialreg::spautolm(log(scale) ~ -1 + Reg1 + Reg2 + Reg3, \n                                        data = dat_win_22, family=\"CAR\", \n                                        listw=mat2listw(1/D_22,style = \"C\"))\ncar_rate_22 <- spatialreg::spautolm(rate ~ -1 + Reg1 + Reg2 + Reg3, \n                                    data = dat_win_22, family=\"CAR\", \n                                    listw=mat2listw(1/D_22, style = \"C\"))\n## extract parameter estimates\npar_22 <- get_par_car(car_ln.scale_22, car_shape_22, car_rate_22)\nse_22 <- get_se(car_ln.scale_22, car_shape_22, car_rate_22)[3,]\ncar_varcov_22 <- make_varcov_mats_car(car_ln.scale_22, car_shape_22)  # se of scale 8.5, 4, 9.25\nst_devs_22 <- data.frame(Reg1 = c(sqrt(diag(car_varcov_22[[1]])), se_22[1]),\n                         Reg2 = c(sqrt(diag(car_varcov_22[[2]])), se_22[2]), \n                         Reg3 = c(sqrt(diag(car_varcov_22[[3]])), se_22[3]))\nrow.names(st_devs_22) <- row.names(par_22)\n\n\n\n## window 52\n## Fit models\ncar_shape_52 <- spatialreg::spautolm(shape ~ -1 + Reg1 + Reg2 + Reg3, \n                                     data = dat_win_52, family=\"CAR\", \n                                     listw=mat2listw(1/D_52, style = \"C\"))\ncar_ln.scale_52 <- spatialreg::spautolm(log(scale) ~ -1 + Reg1 + Reg2 + Reg3, \n                                        data = dat_win_52, family=\"CAR\", \n                                        listw=mat2listw(1/D_52, style = \"C\"))\ncar_rate_52 <- spatialreg::spautolm(rate ~ -1 + Reg1 + Reg2 + Reg3, \n                                    data = dat_win_52, family=\"CAR\", \n                                    listw=mat2listw(1/D_52, style = \"C\"))\n## Extract parameter estimates\npar_52 <- get_par_car(car_ln.scale_52, car_shape_52, car_rate_52)\nse_52 <- get_se(car_ln.scale_52, car_shape_52, car_rate_52)[3,]\ncar_varcov_52 <- make_varcov_mats_car(car_ln.scale_52, car_shape_52)  # se of scale 8.5, 4, 9.25\nst_devs_52 <- data.frame(Reg1 = c(sqrt(diag(car_varcov_52[[1]])), se_52[1]),\n                         Reg2 = c(sqrt(diag(car_varcov_52[[2]])), se_52[2]), \n                         Reg3 = c(sqrt(diag(car_varcov_52[[3]])), se_52[3]))\n\n## window 82\n## fit models\ncar_shape_82 <- spatialreg::spautolm(shape ~ -1 + Reg1 + Reg2 + Reg3, \n                                     data = dat_win_82, family=\"CAR\", \n                                     listw=mat2listw(1/D_82, style = \"C\"))\ncar_ln.scale_82 <- spatialreg::spautolm(log(scale) ~ -1 + Reg1 + Reg2 + Reg3, \n                                        data = dat_win_82, family=\"CAR\", \n                                        listw=mat2listw(1/D_82, style = \"C\"))\ncar_rate_82 <- spatialreg::spautolm(rate ~ -1 + Reg1 + Reg2 + Reg3, \n                                    data = dat_win_82, family=\"CAR\", \n                                    listw=mat2listw(1/D_82, style = \"C\"))\n## Extract parameter estiamtes\npar_82 <- get_par_car(car_ln.scale_82, car_shape_82, car_rate_82)\nse_82 <- get_se(car_ln.scale_82, car_shape_82, car_rate_82)[3,]\ncar_varcov_82 <- make_varcov_mats_car(car_ln.scale_82, car_shape_82)  # se of scale 8.5, 4, 9.25\nst_devs_82 <- data.frame(Reg1 = c(sqrt(diag(car_varcov_82[[1]])), se_82[1]),\n                         Reg2 = c(sqrt(diag(car_varcov_82[[2]])), se_82[2]), \n                         Reg3 = c(sqrt(diag(car_varcov_82[[3]])), se_82[3]))\n```\n:::\n\n\n\n### Table of parameter estimates\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Parameters\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Reg1         Reg2         Reg3\nscale 230.85855709 200.15626351 198.45979895\nshape  -0.01912063   0.05329551   0.14923817\nrate    0.02814622   0.03138875   0.03426008\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Standard Errors\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Reg1         Reg2         Reg3\nscale 5.3213141641 3.0221032578 4.5999740852\nshape 0.0313947823 0.0204812334 0.0315739476\nrate  0.0005872697 0.0003877783 0.0005903755\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Parameters\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Reg1        Reg2         Reg3\nscale 171.95531347 202.3189569 217.80371166\nshape   0.17232481   0.1340430   0.16194601\nrate    0.02981064   0.0317399   0.03388214\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Standard Errors\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Reg1         Reg2         Reg3\n1 4.4827004098 2.7176004289 6.6253934853\n2 0.0131459688 0.0067930158 0.0153266095\n3 0.0006522969 0.0003391368 0.0007591396\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Parameters\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Reg1         Reg2         Reg3\nscale 215.07848444 236.68456472 223.98647292\nshape   0.20456458   0.16327472   0.18610913\nrate    0.05510062   0.04333857   0.05629901\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Standard Errors\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         Reg1        Reg2        Reg3\n1 4.323191117 4.894934005 3.699432968\n2 0.016361116 0.016841085 0.013420937\n3 0.002272369 0.002339033 0.001864008\n```\n\n\n:::\n:::\n\n\n\n## Calculate return levels + CIs\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Estimates and CIs for visuals\ncar_rl_25_22  <- rl_with_ci(par_mat = par_22, \n                            varcov_list = car_varcov_22, \n                            return_period = 25, \n                            type = \"ci\", alpha = 0.05)/254\ncar_rl_100_22 <- rl_with_ci(par_22, car_varcov_22, 100, \"ci\")/254\ncar_rl_500_22 <- rl_with_ci(par_22, car_varcov_22, 500, \"ci\")/254\n\ncar_rl_25_52  <- rl_with_ci(par_52, car_varcov_52, 25, \"ci\")/254\ncar_rl_100_52 <- rl_with_ci(par_52, car_varcov_52, 100, \"ci\")/254\ncar_rl_500_52 <- rl_with_ci(par_52, car_varcov_52, 500, \"ci\")/254\n\ncar_rl_25_82  <- rl_with_ci(par_82, car_varcov_82, 25, \"ci\")/254\ncar_rl_100_82 <- rl_with_ci(par_82, car_varcov_82, 100, \"ci\")/254\ncar_rl_500_82 <- rl_with_ci(par_82, car_varcov_82, 500, \"ci\")/254\n\nwin_1 <- rl_ci_to_plot_vec(car_rl_25_22, car_rl_100_22, car_rl_500_22)\nwin_2 <- rl_ci_to_plot_vec(car_rl_25_52, car_rl_100_52, car_rl_500_52)\nwin_3 <- rl_ci_to_plot_vec(car_rl_25_82, car_rl_100_82, car_rl_500_82)\n\nplot_dat <- win_rl_to_plot_dat(win_1, win_2, win_3)\nreg1 <- plot_dat[[1]] # Region 1 data frame for plotting\nreg2 <- plot_dat[[2]] \nreg3 <- plot_dat[[3]] \n```\n:::\n\n\n\n### Visualize return levels\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=reg1, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n    geom_line(aes(y=RL_500, color=\"500-Year\", linetype = \"500-Year\")) + geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_ribbon(aes(ymin=LB_500, ymax=UB_500), alpha=0.07, fill=\"darkblue\") +\n    geom_line(aes(y=RL_100, color=\"100-Year\", linetype = \"100-Year\")) + geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_ribbon(aes(ymin=LB_100, ymax=UB_100), alpha=0.07, fill=\"blue\") +\n    geom_line(aes(y=RL_25, color=\"25-Year\", linetype = \"25-Year\")) + geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_ribbon(aes(ymin=LB_25, ymax=UB_25), alpha=0.15, fill=\"lightblue\") +\n    labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Model 1 - Region 1\") +\n    scale_colour_manual(name = \"Return Period\", values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_linetype_manual(values = c(\"500-Year\" = \n    \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + guides(colour = guide_legend(override.aes = list(shape = NA)))\n```\n\n::: {.cell-output-display}\n![](PARE_files/figure-pdf/visualize-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\nggplot(data=reg2, aes(x=c(1960, 1990, 2020))) + \n  coord_cartesian(ylim = c(3, 41.5)) +\n  geom_line(aes(y=RL_500, color=\"500-Year\", linetype = \"500-Year\")) + geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_ribbon(aes(ymin=LB_500, ymax=UB_500), alpha=0.07, fill=\"darkred\") +\n  geom_line(aes(y=RL_100, color=\"100-Year\", linetype = \"100-Year\")) + geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_ribbon(aes(ymin=LB_100, ymax=UB_100), alpha=0.07, fill=\"red\") +\n  geom_line(aes(y=RL_25, color=\"25-Year\", linetype = \"25-Year\")) + geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_ribbon(aes(ymin=LB_25, ymax=UB_25), alpha=0.15, fill=\"pink\") +\n  labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Model 1 - Region 2\") +\n  scale_colour_manual(name = \"Return Period\", values = c('500-Year' = \"darkred\", '100-Year' = \"red\", '25-Year' = \"pink\"),\n                      breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_linetype_manual(values = c(\"500-Year\" = \n    \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + guides(colour = guide_legend(override.aes = list(shape = NA)))\n```\n\n::: {.cell-output-display}\n![](PARE_files/figure-pdf/visualize-2.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\nggplot(data=reg3, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n    geom_line(aes(y=RL_500, color=\"500-Year\", linetype = \"500-Year\")) + geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_ribbon(aes(ymin=LB_500, ymax=UB_500), alpha=0.3, fill=\"#256e3a\") +\n    geom_line(aes(y=RL_100, color=\"100-Year\", linetype = \"100-Year\")) + geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_ribbon(aes(ymin=LB_100, ymax=UB_100), alpha=0.2, fill=\"#5d916c\") +\n    geom_line(aes(y=RL_25, color=\"25-Year\" , linetype = \"25-Year\")) + geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_ribbon(aes(ymin=LB_25, ymax=UB_25), alpha=0.15, fill=\"#44c96a\") +\n    labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Model 1 - Region 3\") +\n    scale_colour_manual(name = \"Return Period\",\n                        values = c('500-Year' = \"#256e3a\", '100-Year' = \"#5d916c\", '25-Year' = \"#44c96a\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) +\n    scale_linetype_manual(values = c(\"500-Year\" = \n    \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + guides(colour = guide_legend(override.aes = list(shape = NA)))\n```\n\n::: {.cell-output-display}\n![](PARE_files/figure-pdf/visualize-3.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Updated Visualizations\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## define horizontal limits for error bars\nreg1$LB_X <- reg2$LB_X <- reg3$LB_X <- c(1957, 1987, 2017)\nreg1$UB_X <- reg2$UB_X <- reg3$UB_X <- c(1963, 1993, 2023)\n\n## legend \ng <- guides(fill = guide_legend(override.aes = list(color = c(\"black\", \"black\", \"black\"),\n                                                    shape = c(15, 16, 18), \n                                                    fill = c(\"black\", \"black\", \"black\"),\n                                                    linetype = c(1,1,1),\n                                                    size = c(2,2,3)\n                                                    )))\n\n## Region 1\nreg1_plot <- ggplot(data=reg1, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    #geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 3) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_x_continuous(breaks = c(1960, 1990,2020)) +\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"skyblue\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 18), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"\", y=\"Return Level (in)\", title=\"Region 1\") + theme_minimal() +   theme(legend.position=\"none\",  \n        axis.text.y = element_text(size = 15), \n        axis.text.x = element_text(size = 12), \n        axis.title.x = element_text(size = 15), \n        title = element_text(size = 15))\n\n## Region 2\nreg2_plot <- ggplot(data=reg2, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 3) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_x_continuous(breaks = c(1960, 1990,2020)) +\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"darkred\", '100-Year' = \"red\", '25-Year' = \"pink\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"darkred\", '100-Year' = \"red\", '25-Year' = \"pink\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 18), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"Last Year of 40-Year Window\", y=\"\", title=\"Region 2\") + theme_minimal() + g +   theme(legend.position=\"bottom\",  \n        axis.text.y = element_text(size = 15), \n        axis.text.x = element_text(size = 12), \n        axis.title.x = element_text(size = 15), \n        title = element_text(size = 15))\n\n\n\n## Region 3\nreg3_plot <- ggplot(data=reg3, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 3) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_x_continuous(breaks = c(1960, 1990,2020)) +\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"#256e3a\", '100-Year' = \"#5d916c\", '25-Year' = \"#44c96a\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"#256e3a\", '100-Year' = \"#5d916c\", '25-Year' = \"#44c96a\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 18), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"\", y=\"\", title=\"Region 3\") + theme_minimal() + \n    theme(legend.position=\"none\",  \n        axis.text.y = element_text(size = 15), \n        axis.text.x = element_text(size = 12), \n        axis.title.x = element_text(size = 15), \n        title = element_text(size = 15))\n\n\n\n\n\nPARE_plot = reg1_plot + reg2_plot + reg3_plot +plot_layout(ncol = 3) + \n  plot_annotation(\"Estimated Return Levels - PARE\") & theme(plot.title = element_text(size = 15))\n\nggsave(\"Images/PARE_plot.png\", plot = PARE_plot, width = 7.5, height = 3.5, units = \"in\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## OLD \n## just errorbars\nggplot(data=reg1, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    #geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    #geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 2) + \n    #geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"skyblue\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 17), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Model 1 - Region 1\") + theme_minimal()\n\n\n\n## OLD\nggplot(data=reg1, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n    geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+\n    geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\")) +\n    geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\")) +\n    scale_colour_manual(name = \"Return Period\", values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"twodash\", \"100-Year\" = \"dash\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n     labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Model 1 - Region 1\") +\n     guides(colour = guide_legend(override.aes = list(shape = NA)))\n\n\n## define X axis limits\nreg1$LB_X = c(1957, 1987, 2017)\nreg1$UB_X = c(1963, 1993, 2023)\n\nggplot(data=reg1, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.05)+\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2)  +\n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.05)+\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.05)+\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 2) +\n    labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels and 95% Confidence Intervals - PARE Model- Region 1\") +\n    scale_colour_manual(name = \"Return Period\", values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"skyblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 17), breaks = c('500-Year', '100-Year', '25-Year')) +theme_minimal()\n\n## shading and error bars\nggplot(data=reg1, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"skyblue\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 17), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Model 1 - Region 1\") + theme_minimal()\n\n## just errorbars\nggplot(data=reg1, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    #geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    #geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    #geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"skyblue\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 17), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Model 1 - Region 1\") + theme_minimal()\n\n\nggplot(data=reg2, aes(x=c(1960, 1990, 2020))) + \n  coord_cartesian(ylim = c(3, 41.5)) +\n  geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col =\"500-Year\", linetype = \"500-Year\")) +\n  geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\")) +\n  geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\")) +\n  labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Model 1 - Region 2\") +\n  scale_colour_manual(name = \"Return Period\", values = c('500-Year' = \"darkred\", '100-Year' = \"red\", '25-Year' = \"pink\"),\n                      breaks = c('500-Year', '100-Year', '25-Year'))+\n  scale_linetype_manual(values = c(\"500-Year\" = \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), \n                        breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + \n  guides(colour = guide_legend(override.aes = list(shape = NA)))\n\nggplot(data=reg3, aes(x=c(1960, 1990, 2020))) + \n  coord_cartesian(ylim = c(3, 41.5)) +\n  geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col =\"500-Year\", linetype = \"500-Year\")) +\n  geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col = \"100-Year\", linetype = \"100-Year\")) +\n  geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col = \"25-Year\", linetype = \"25-Year\")) +\n  labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Model 1 - Region 3\") +\n  scale_colour_manual(name = \"Return Period\",\n                        values = c('500-Year' = \"#256e3a\", '100-Year' = \"#5d916c\", '25-Year' = \"#44c96a\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) +\n    scale_linetype_manual(values = c(\"500-Year\" = \n    \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + guides(colour = guide_legend(override.aes = list(shape = NA)))\n```\n:::\n\n\n\n### Table of return levels\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Table 6\ncar_rl_25_22_se  <- rl_with_ci(par_mat = par_22, \n                            varcov_list = car_varcov_22, \n                            return_period = 25, \n                            type = \"se\", alpha = 0.05)/254\ncar_rl_100_22_se <- rl_with_ci(par_22, car_varcov_22, 100, \"se\")/254\ncar_rl_500_22_se <- rl_with_ci(par_22, car_varcov_22, 500, \"se\")/254\n\n## latex output\ncar_rl_22_list <- list(car_rl_25_22_se, car_rl_100_22_se, car_rl_500_22_se)\nget_latex_table_RL(car_rl_22_list)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n&25-yr RL&5.781(0.4269)&6.2(0.3274)&8.102(0.7539)\\\\\n&100-yr RL&6.9(0.645)&7.733(0.5268)&10.938(1.3344)\\\\\n&500-yr RL&8.161(0.9508)&9.66(0.8373)&15.059(2.3736)\\\\\n```\n\n\n:::\n\n```{.r .cell-code}\nrbind(t(car_rl_25_22_se), t(car_rl_100_22_se), t(car_rl_500_22_se))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Reg1      Reg2       Reg3\n25-yr RL  5.7812602 6.2000477  8.1017057\nSE        0.4268857 0.3273666  0.7538876\n100-yr RL 6.8995253 7.7328867 10.9382561\nSE        0.6450349 0.5268412  1.3344426\n500-yr RL 8.1611487 9.6604967 15.0588530\nSE        0.9508076 0.8372663  2.3736257\n```\n\n\n:::\n\n```{.r .cell-code}\n## Table 7\ncar_rl_25_52_se  <- rl_with_ci(par_52, car_varcov_52, 25, \"se\")/254\ncar_rl_100_52_se <- rl_with_ci(par_52, car_varcov_52, 100, \"se\")/254\ncar_rl_500_52_se <- rl_with_ci(par_52, car_varcov_52, 500, \"se\")/254\n\n# Latex output\ncar_rl_52_list <- list(car_rl_25_52_se, car_rl_100_52_se, car_rl_500_52_se)\nget_latex_table_RL(car_rl_52_list)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n&25-yr RL&7.391(0.3201)&7.759(0.1733)&9.104(0.4793)\\\\\n&100-yr RL&10.177(0.5587)&10.354(0.2883)&12.477(0.8223)\\\\\n&500-yr RL&14.367(0.9991)&14.038(0.4891)&17.472(1.4436)\\\\\n```\n\n\n:::\n\n```{.r .cell-code}\nrbind(t(car_rl_25_52_se), t(car_rl_100_52_se), t(car_rl_500_52_se))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                Reg1       Reg2       Reg3\n25-yr RL   7.3910220  7.7591772  9.1036876\nSE         0.3201394  0.1732745  0.4792676\n100-yr RL 10.1767483 10.3537503 12.4771511\nSE         0.5586972  0.2883097  0.8222935\n500-yr RL 14.3667665 14.0375739 17.4724334\nSE         0.9991024  0.4890933  1.4436359\n```\n\n\n:::\n\n```{.r .cell-code}\n## TABLE 3\ncar_rl_25_82_se  <- rl_with_ci(par_82, car_varcov_82, 25, \"se\")/254\ncar_rl_100_82_se <- rl_with_ci(par_82, car_varcov_82, 100, \"se\")/254\ncar_rl_500_82_se <- rl_with_ci(par_82, car_varcov_82, 500, \"se\")/254\n\n# Latex output\ncar_rl_82_list <- list(car_rl_25_82_se, car_rl_100_82_se, car_rl_500_82_se)\nget_latex_table_RL(car_rl_82_list)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n&25-yr RL&11.634(0.6874)&10.442(0.5857)&11.399(0.5461)\\\\\n&100-yr RL&16.48(1.2435)&14.291(1.0239)&15.856(0.9666)\\\\\n&500-yr RL&24.131(2.3097)&20.002(1.8186)&22.7(1.7504)\\\\\n```\n\n\n:::\n\n```{.r .cell-code}\nrbind(t(car_rl_25_82_se), t(car_rl_100_82_se), t(car_rl_500_82_se))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Reg1       Reg2       Reg3\n25-yr RL  11.634249 10.4422599 11.3992557\nSE         0.687375  0.5856544  0.5461398\n100-yr RL 16.479569 14.2913625 15.8560177\nSE         1.243511  1.0239274  0.9666489\n500-yr RL 24.130583 20.0023744 22.7002292\nSE         2.309727  1.8186076  1.7503930\n```\n\n\n:::\n:::\n\n\n\n## Block Kriging\n\n### Read data for Block Kriging Return Level plots from Fagnant '21\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## read in values for Block Kriging-- read from Fagnant 2021\nreg1_bk <- data.frame(RL_25 = c(6.681,7.337,12.008), \n                   RL_100 = c(8.472,9.900,17.277), \n                   RL_500 = c(10.789,13.621,25.800))\nreg1_bk$LB_25 = reg1_bk$RL_25 - 1.96*c(1.578,0.670,2.266)\nreg1_bk$UB_25 = reg1_bk$RL_25 + 1.96*c(1.578,0.670,2.266)\n\nreg1_bk$LB_100 = reg1_bk$RL_100 - 1.96*c(2.630,1.244,4.485)\nreg1_bk$UB_100 = reg1_bk$RL_100 + 1.96*c(2.630,1.244,4.485)\n\nreg1_bk$LB_500 = reg1_bk$RL_500 - 1.96*c(4.319, 2.299,8.969)\nreg1_bk$UB_500 = reg1_bk$RL_500 + 1.96*c(4.319, 2.299,8.969)\n\nreg1_bk$LB_X <- c(1957, 1987, 2017)\nreg1_bk$UB_X <- c(1963, 1993, 2023)\n\nreg2_bk <- data.frame(RL_25 = c(7.523,6.289,11.210), \n                   RL_100 = c(10.073,7.818,15.465), \n                   RL_500 = c(13.717,9.728,21.911))\n\nreg2_bk$LB_25 = reg2_bk$RL_25 - 1.96*c(1.895, 0.462, 2.06)\nreg2_bk$UB_25 = reg2_bk$RL_25 + 1.96*c(1.895, 0.462, 2.06)\n\nreg2_bk$LB_100 = reg2_bk$RL_100 - 1.96*c(3.372,0.771,3.89)\nreg2_bk$UB_100 = reg2_bk$RL_100 + 1.96*c(3.372,0.771,3.89)\n\nreg2_bk$LB_500 = reg2_bk$RL_500 - 1.96*c(5.990, 1.260,7.36)\nreg2_bk$UB_500 = reg2_bk$RL_500 + 1.96*c(5.990, 1.260,7.36)\n\nreg2_bk$LB_X <- c(1957, 1987, 2017)\nreg2_bk$UB_X <- c(1963, 1993, 2023)\n\n\nreg3_bk <- data.frame(RL_25 = c(7.376,7.950,9.141), \n                   RL_100 = c(9.784,10.650,11.865), \n                   RL_500 = c(13.170,14.511,15.607))\n\nreg3_bk$LB_25 = reg3_bk$RL_25 - 1.96*c(1.885,0.823, 1.44)\nreg3_bk$UB_25 = reg3_bk$RL_25 + 1.96*c(1.885,0.823, 1.44)\n\nreg3_bk$LB_100 = reg3_bk$RL_100 - 1.96*c(3.335,1.511, 2.54)\nreg3_bk$UB_100 = reg3_bk$RL_100 + 1.96*c(3.335,1.511, 2.54)\n\nreg3_bk$LB_500 = reg3_bk$RL_500 - 1.96*c(5.870,2.757,4.44)\nreg3_bk$UB_500 = reg3_bk$RL_500 + 1.96*c(5.870,2.757,4.44)\n\nreg3_bk$LB_X <- c(1957, 1987, 2017)\nreg3_bk$UB_X <- c(1963, 1993, 2023)\n```\n:::\n\n\n\n### Block Kriging– Original plots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=reg1_bk, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n    geom_line(aes(y=RL_500, color=\"500-Year\", linetype = \"500-Year\")) + geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_ribbon(aes(ymin=LB_500, ymax=UB_500), alpha=0.07, fill=\"darkblue\") +\n    geom_line(aes(y=RL_100, color=\"100-Year\", linetype = \"100-Year\")) + geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_ribbon(aes(ymin=LB_100, ymax=UB_100), alpha=0.07, fill=\"blue\") +\n    geom_line(aes(y=RL_25, color=\"25-Year\", linetype = \"25-Year\")) + geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_ribbon(aes(ymin=LB_25, ymax=UB_25), alpha=0.15, fill=\"lightblue\") +\n    labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Block Kriging - Region 1\") +\n    scale_colour_manual(name = \"Return Period\", values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_linetype_manual(values = c(\"500-Year\" = \n    \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + guides(colour = guide_legend(override.aes = list(shape = NA)))\n```\n\n::: {.cell-output-display}\n![](PARE_files/figure-pdf/unnamed-chunk-14-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\nggplot(data=reg2_bk, aes(x=c(1960, 1990, 2020))) + \n  coord_cartesian(ylim = c(3, 41.5)) +\n  geom_line(aes(y=RL_500, color=\"500-Year\", linetype = \"500-Year\")) + geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_ribbon(aes(ymin=LB_500, ymax=UB_500), alpha=0.07, fill=\"darkred\") +\n  geom_line(aes(y=RL_100, color=\"100-Year\", linetype = \"100-Year\")) + geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_ribbon(aes(ymin=LB_100, ymax=UB_100), alpha=0.07, fill=\"red\") +\n  geom_line(aes(y=RL_25, color=\"25-Year\", linetype = \"25-Year\")) + geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_ribbon(aes(ymin=LB_25, ymax=UB_25), alpha=0.15, fill=\"pink\") +\n  labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Block Kriging - Region 2\") +\n  scale_colour_manual(name = \"Return Period\", values = c('500-Year' = \"darkred\", '100-Year' = \"red\", '25-Year' = \"pink\"),\n                      breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_linetype_manual(values = c(\"500-Year\" = \n    \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + guides(colour = guide_legend(override.aes = list(shape = NA)))\n```\n\n::: {.cell-output-display}\n![](PARE_files/figure-pdf/unnamed-chunk-14-2.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\nggplot(data=reg3_bk, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n    geom_line(aes(y=RL_500, color=\"500-Year\", linetype = \"500-Year\")) + geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_ribbon(aes(ymin=LB_500, ymax=UB_500), alpha=0.3, fill=\"#256e3a\") +\n    geom_line(aes(y=RL_100, color=\"100-Year\", linetype = \"100-Year\")) + geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_ribbon(aes(ymin=LB_100, ymax=UB_100), alpha=0.2, fill=\"#5d916c\") +\n    geom_line(aes(y=RL_25, color=\"25-Year\" , linetype = \"25-Year\")) + geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_ribbon(aes(ymin=LB_25, ymax=UB_25), alpha=0.15, fill=\"#44c96a\") +\n    labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Block Kriging - Region 3\") +\n    scale_colour_manual(name = \"Return Period\",\n                        values = c('500-Year' = \"#256e3a\", '100-Year' = \"#5d916c\", '25-Year' = \"#44c96a\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) +\n    scale_linetype_manual(values = c(\"500-Year\" = \n    \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + guides(colour = guide_legend(override.aes = list(shape = NA)))\n```\n\n::: {.cell-output-display}\n![](PARE_files/figure-pdf/unnamed-chunk-14-3.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Updated Plots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## legend \ng <- guides(fill = guide_legend(override.aes = list(color = c(\"black\", \"black\", \"black\"),\n                                                    shape = c(15, 16, 18), \n                                                    fill = c(\"black\", \"black\", \"black\"),\n                                                    linetype = c(1,1,1),\n                                                    size = c(2,2,3)\n                                                    )))\n\n## Region 1\nreg1_bk_plot <- ggplot(data=reg1_bk, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    #geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 3) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_x_continuous(breaks = c(1960, 1990,2020)) +\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"skyblue\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 18), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"\", y=\"Return Level (in)\", title=\"Region 1\") + theme_minimal() +   theme(legend.position=\"none\",  \n        axis.text.y = element_text(size = 15), \n        axis.text.x = element_text(size = 12), \n        axis.title.x = element_text(size = 15), \n        title = element_text(size = 15))\n\n\n## Region 2\nreg2_bk_plot <- ggplot(data=reg2_bk, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 3) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_x_continuous(breaks = c(1960, 1990,2020)) +\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"darkred\", '100-Year' = \"red\", '25-Year' = \"pink\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"darkred\", '100-Year' = \"red\", '25-Year' = \"pink\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 18), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"Last Year of 40-Year Window\", y=\"\", title=\"Region 2\") + theme_minimal() + g +   theme(legend.position=\"bottom\",  \n        axis.text.y = element_text(size = 15), \n        axis.text.x = element_text(size = 12), \n        axis.title.x = element_text(size = 15), \n        title = element_text(size = 15))\n\n\n\n## Region 3\nreg3_bk_plot <- ggplot(data=reg3_bk, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 3) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_x_continuous(breaks = c(1960, 1990,2020)) +\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"#256e3a\", '100-Year' = \"#5d916c\", '25-Year' = \"#44c96a\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"#256e3a\", '100-Year' = \"#5d916c\", '25-Year' = \"#44c96a\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 18), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"\", y=\"\", title=\"Region 3\") + theme_minimal() + \n  theme(legend.position=\"none\",  \n        axis.text.y = element_text(size = 15), \n        axis.text.x = element_text(size = 12), \n        axis.title.x = element_text(size = 15), \n        title = element_text(size = 15))\n\n\n\n\n\nBK_plot = reg1_bk_plot + reg2_bk_plot + reg3_bk_plot +plot_layout(ncol = 3) + plot_annotation(\"Estimated Return Levels - Block Kriging\") & theme(plot.title = element_text(size = 15))\n\nggsave(\"Images/BK_plot.png\", plot = BK_plot, width = 7.5, height = 3.5, units = \"in\")\n```\n:::\n\n\n\n## Regional Max\n\n### Read data for Regional Max Return Level plots from Fagnant '21\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## read in values for Regional Max-- read from Fagnant 2021\nreg1_rm <- data.frame(RL_25 = c(9.349, 9.552, 12.96), \n                   RL_100 = c(12.073, 12.295, 17.54), \n                   RL_500 = c(15.759, 15.999, 24.23))\nreg1_rm$LB_25 = reg1_rm$RL_25 - 1.96*c(1.354, 0.854, 1.33)\nreg1_rm$UB_25 = reg1_rm$RL_25 + 1.96*c(1.354, 0.854, 1.33)\n\nreg1_rm$LB_100 = reg1_rm$RL_100 - 1.96*c(2.341, 1.455, 2.39)\nreg1_rm$UB_100 = reg1_rm$RL_100 + 1.96*c(2.341, 1.455, 2.39)\n\nreg1_rm$LB_500 = reg1_rm$RL_500 - 1.96*c(4.016, 2.470, 4.32)\nreg1_rm$UB_500 = reg1_rm$RL_500 + 1.96*c(4.016, 2.470, 4.32)\n\nreg1_rm$LB_X <- c(1957, 1987, 2017)\nreg1_rm$UB_X <- c(1963, 1993, 2023)\n\nreg2_rm <- data.frame(RL_25 = c(10.895, 11.858, 14.68), \n                   RL_100 = c(15.050, 15.272, 19.68), \n                   RL_500 = c(21.297, 19.852, 26.83))\n\nreg2_rm$LB_25 = reg2_rm$RL_25 - 1.96*c(1.283, 1.025, 1.44)\nreg2_rm$UB_25 = reg2_rm$RL_25 + 1.96*c(1.283, 1.025, 1.44)\n\nreg2_rm$LB_100 = reg2_rm$RL_100 - 1.96*c(2.402, 1.730, 2.53)\nreg2_rm$UB_100 = reg2_rm$RL_100 + 1.96*c(2.402, 1.730, 2.53)\n\nreg2_rm$LB_500 = reg2_rm$RL_500 - 1.96*c(4.517,2.909,4.48)\nreg2_rm$UB_500 = reg2_rm$RL_500 + 1.96*c(4.517,2.909,4.48)\n\nreg2_rm$LB_X <- c(1957, 1987, 2017)\nreg2_rm$UB_X <- c(1963, 1993, 2023)\n\n\nreg3_rm <- data.frame(RL_25 = c(10.037,11.636, 13.75), \n                   RL_100 = c(13.553, 16.109, 18.37), \n                   RL_500 = c(18.659, 22.889, 24.94))\n\nreg3_rm$LB_25 = reg3_rm$RL_25 - 1.96*c(1.179, 1.381, 1.35)\nreg3_rm$UB_25 = reg3_rm$RL_25 + 1.96*c(1.179, 1.381, 1.35)\n\nreg3_rm$LB_100 = reg3_rm$RL_100 - 1.96*c(2.161,2.578, 2.39)\nreg3_rm$UB_100 = reg3_rm$RL_100 + 1.96*c(2.161,2.578, 2.39)\n\nreg3_rm$LB_500 = reg3_rm$RL_500 - 1.96*c(3.956, 4.847, 4.22)\nreg3_rm$UB_500 = reg3_rm$RL_500 + 1.96*c(3.956, 4.847, 4.22)\n\nreg3_rm$LB_X <- c(1957, 1987, 2017)\nreg3_rm$UB_X <- c(1963, 1993, 2023)\n```\n:::\n\n\n\n### Regional Max– Original plots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=reg1_rm, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n    geom_line(aes(y=RL_500, color=\"500-Year\", linetype = \"500-Year\")) + geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_ribbon(aes(ymin=LB_500, ymax=UB_500), alpha=0.07, fill=\"darkblue\") +\n    geom_line(aes(y=RL_100, color=\"100-Year\", linetype = \"100-Year\")) + geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_ribbon(aes(ymin=LB_100, ymax=UB_100), alpha=0.07, fill=\"blue\") +\n    geom_line(aes(y=RL_25, color=\"25-Year\", linetype = \"25-Year\")) + geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_ribbon(aes(ymin=LB_25, ymax=UB_25), alpha=0.15, fill=\"lightblue\") +\n    labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Regional Max - Region 1\") +\n    scale_colour_manual(name = \"Return Period\", values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_linetype_manual(values = c(\"500-Year\" = \n    \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + guides(colour = guide_legend(override.aes = list(shape = NA)))\n```\n\n::: {.cell-output-display}\n![](PARE_files/figure-pdf/unnamed-chunk-17-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\nggplot(data=reg2_rm, aes(x=c(1960, 1990, 2020))) + \n  coord_cartesian(ylim = c(3, 41.5)) +\n  geom_line(aes(y=RL_500, color=\"500-Year\", linetype = \"500-Year\")) + geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_ribbon(aes(ymin=LB_500, ymax=UB_500), alpha=0.07, fill=\"darkred\") +\n  geom_line(aes(y=RL_100, color=\"100-Year\", linetype = \"100-Year\")) + geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_ribbon(aes(ymin=LB_100, ymax=UB_100), alpha=0.07, fill=\"red\") +\n  geom_line(aes(y=RL_25, color=\"25-Year\", linetype = \"25-Year\")) + geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_ribbon(aes(ymin=LB_25, ymax=UB_25), alpha=0.15, fill=\"pink\") +\n  labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Regional Max - Region 2\") +\n  scale_colour_manual(name = \"Return Period\", values = c('500-Year' = \"darkred\", '100-Year' = \"red\", '25-Year' = \"pink\"),\n                      breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_linetype_manual(values = c(\"500-Year\" =  \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + guides(colour = guide_legend(override.aes = list(shape = NA)))\n```\n\n::: {.cell-output-display}\n![](PARE_files/figure-pdf/unnamed-chunk-17-2.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\nggplot(data=reg3_rm, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n    geom_line(aes(y=RL_500, color=\"500-Year\", linetype = \"500-Year\")) + geom_point(aes(y=RL_500, color=\"500-Year\")) + geom_ribbon(aes(ymin=LB_500, ymax=UB_500), alpha=0.3, fill=\"#256e3a\") +\n    geom_line(aes(y=RL_100, color=\"100-Year\", linetype = \"100-Year\")) + geom_point(aes(y=RL_100, color=\"100-Year\"))+ geom_ribbon(aes(ymin=LB_100, ymax=UB_100), alpha=0.2, fill=\"#5d916c\") +\n    geom_line(aes(y=RL_25, color=\"25-Year\" , linetype = \"25-Year\")) + geom_point(aes(y=RL_25, color=\"25-Year\")) + geom_ribbon(aes(ymin=LB_25, ymax=UB_25), alpha=0.15, fill=\"#44c96a\") +\n    labs(x=\"Last Year of 40-Year Window\", y=\"Return Level (in)\", title=\"Estimated Return Levels - Regional Max - Region 3\") +\n    scale_colour_manual(name = \"Return Period\",\n                        values = c('500-Year' = \"#256e3a\", '100-Year' = \"#5d916c\", '25-Year' = \"#44c96a\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) +\n    scale_linetype_manual(values = c(\"500-Year\" = \n    \"twodash\", \"100-Year\" = \"longdash\", \"25-Year\" = \"solid\"), breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") + guides(colour = guide_legend(override.aes = list(shape = NA)))\n```\n\n::: {.cell-output-display}\n![](PARE_files/figure-pdf/unnamed-chunk-17-3.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Updated plots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## legend \ng <- guides(fill = guide_legend(override.aes = list(color = c(\"black\", \"black\", \"black\"),\n                                                    shape = c(15, 16, 18), \n                                                    fill = c(\"black\", \"black\", \"black\"),\n                                                    linetype = c(1,1,1),\n                                                    size = c(2,2,3)\n                                                    )))\n\n## Region 1\nreg1_rm_plot <- ggplot(data=reg1_rm, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    #geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 3) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_x_continuous(breaks = c(1960, 1990,2020)) +\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"skyblue\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"darkblue\", '100-Year' = \"blue\", '25-Year' = \"lightblue\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 18), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"\", y=\"Return Level (in)\", title=\"Region 1\") + theme_minimal() +\n    theme(legend.position=\"none\",  \n        axis.text.y = element_text(size = 15), \n        axis.text.x = element_text(size = 12), \n        axis.title.x = element_text(size = 15), \n        title = element_text(size = 15))\n\n## Region 2\nreg2_rm_plot <- ggplot(data=reg2_rm, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 3) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_x_continuous(breaks = c(1960, 1990,2020)) +\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"darkred\", '100-Year' = \"red\", '25-Year' = \"pink\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"darkred\", '100-Year' = \"red\", '25-Year' = \"pink\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 18), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"Last Year of 40-Year Window\", y=\"\", title=\"Region 2\") + theme_minimal() + g +   theme(legend.position=\"bottom\",  \n        axis.text.y = element_text(size = 15), \n        axis.text.x = element_text(size = 12), \n        axis.title.x = element_text(size = 15), \n        title = element_text(size = 15))\n\n\n## Region 3\nreg3_rm_plot <- ggplot(data=reg3_rm, aes(x=c(1960, 1990, 2020))) + \n    coord_cartesian(ylim = c(3, 41.5)) +\n  ## 500 year\n    geom_point(aes(y=RL_500, color=\"500-Year\", shape = \"500-Year\"), size = 2) + \n    geom_errorbar(aes(ymin=LB_500, ymax=UB_500, col=\"500-Year\", linetype = \"500-Year\"), width = 6)+ \n    geom_rect(aes(ymin=LB_500, ymax=UB_500,xmin = LB_X, xmax = UB_X, fill=\"500-Year\"), alpha=0.1)+\n  ## 100 year\n    geom_point(aes(y=RL_100, color=\"100-Year\", shape = \"100-Year\"), size = 2)+ \n    geom_errorbar(aes(ymin=LB_100, ymax=UB_100, col=\"100-Year\", linetype = \"100-Year\"), width = 6) +     \n    geom_rect(aes(ymin=LB_100, ymax=UB_100,xmin = LB_X, xmax = UB_X, fill=\"100-Year\"), alpha=0.1)+\n  ##25 year\n    geom_point(aes(y=RL_25, color=\"25-Year\", shape = \"25-Year\"), size = 3) + \n    geom_errorbar(aes(ymin=LB_25, ymax=UB_25, col=\"25-Year\", linetype = \"25-Year\"), width = 6) +\n    geom_rect(aes(ymin=LB_25, ymax=UB_25,xmin = LB_X, xmax = UB_X, fill=\"25-Year\"), alpha=0.1)+\n    scale_x_continuous(breaks = c(1960, 1990,2020)) +\n    scale_colour_manual(name = \"Return Period\", \n                        values = c('500-Year' = \"#256e3a\", '100-Year' = \"#5d916c\", '25-Year' = \"#44c96a\"),\n                        breaks = c('500-Year', '100-Year', '25-Year')) + \n    scale_linetype_manual(values = c(\"500-Year\" = \"solid\", \"100-Year\" = \"solid\", \"25-Year\" = \"solid\"),\n                          breaks = c('500-Year', '100-Year', '25-Year'), name = \"Return Period\") +\n  scale_fill_manual(name = \"Return Period\", values =  c('500-Year' = \"#256e3a\", '100-Year' = \"#5d916c\", '25-Year' = \"#44c96a\"), breaks = c('500-Year', '100-Year', '25-Year'))+\n    scale_shape_manual(name = \"Return Period\", values = c('500-Year' = 15, '100-Year' = 16, '25-Year' = 18), breaks = c('500-Year', '100-Year', '25-Year')) +\n     labs(x=\"\", y=\"\", title=\"Region 3\") + theme_minimal() + \n  theme(legend.position=\"none\",  \n        axis.text.y = element_text(size = 15), \n        axis.text.x = element_text(size = 12), \n        axis.title.x = element_text(size = 15), \n        title = element_text(size = 15))\n\n\nRegmax_plot = reg1_rm_plot + reg2_rm_plot + reg3_rm_plot +plot_layout(ncol = 3) + plot_annotation(\"Estimated Return Levels - Regional Max\") & theme(plot.title = element_text(size = 15))\n\nggsave(\"Images/Regmax_plot.png\", plot = Regmax_plot, width = 7.5, height = 3.5, units = \"in\")\n```\n:::\n",
    "supporting": [
      "PARE_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}